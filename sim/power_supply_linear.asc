Version 4.1
SHEET 1 1796 1352
WIRE -736 -80 -832 -80
WIRE -688 -80 -736 -80
WIRE 352 48 304 48
WIRE 480 48 432 48
WIRE -416 64 -448 64
WIRE -304 64 -336 64
WIRE -192 64 -224 64
WIRE -96 64 -112 64
WIRE -80 64 -96 64
WIRE 32 64 0 64
WIRE -96 80 -96 64
WIRE -304 160 -304 64
WIRE 112 160 -304 160
WIRE 304 160 304 48
WIRE 336 160 304 160
WIRE 416 160 400 160
WIRE 432 160 416 160
WIRE 544 160 432 160
WIRE 688 160 544 160
WIRE 912 160 688 160
WIRE 928 160 912 160
WIRE 1040 160 1008 160
WIRE 1120 160 1040 160
WIRE 1328 160 1120 160
WIRE 304 176 304 160
WIRE 432 176 432 160
WIRE 1328 192 1328 160
WIRE -224 208 -224 64
WIRE -128 208 -224 208
WIRE 32 208 32 64
WIRE 32 208 -64 208
WIRE 688 224 688 160
WIRE -224 256 -224 208
WIRE 32 256 32 208
WIRE 304 256 304 240
WIRE 432 256 432 240
WIRE 304 272 304 256
WIRE 336 272 304 272
WIRE 416 272 400 272
WIRE 432 272 432 256
WIRE 432 272 416 272
WIRE 480 272 480 48
WIRE 480 272 432 272
WIRE 1456 272 1328 272
WIRE 1456 288 1456 272
WIRE -560 304 -608 304
WIRE -448 304 -448 64
WIRE -448 304 -480 304
WIRE -288 304 -448 304
WIRE 112 304 112 160
WIRE 112 304 96 304
WIRE -96 352 -224 352
WIRE 32 352 -96 352
WIRE 688 352 688 288
WIRE 688 352 624 352
WIRE 1456 352 1328 352
WIRE 1456 368 1456 352
WIRE 688 432 688 352
WIRE 1456 432 1328 432
WIRE -160 448 -384 448
WIRE -96 448 -96 352
WIRE -96 448 -160 448
WIRE 1456 448 1456 432
WIRE -384 560 -384 448
WIRE 688 560 688 512
WIRE -192 608 -208 608
WIRE -96 608 -128 608
WIRE 592 608 512 608
WIRE 688 608 688 560
WIRE 688 608 592 608
WIRE 448 624 384 624
WIRE 544 640 512 640
WIRE 544 672 544 640
WIRE -480 688 -528 688
WIRE -384 688 -384 640
WIRE -384 688 -416 688
WIRE 688 688 688 608
WIRE 384 704 384 624
WIRE -384 736 -384 688
WIRE 1200 736 1184 736
WIRE 1216 736 1216 656
WIRE 1216 736 1200 736
WIRE 1232 736 1216 736
WIRE -96 800 -96 688
WIRE -96 800 -128 800
WIRE 32 800 -96 800
WIRE -320 816 -336 816
WIRE -304 816 -320 816
WIRE -208 816 -208 608
WIRE -208 816 -224 816
WIRE -192 816 -208 816
WIRE -80 832 -128 832
WIRE 384 832 384 784
WIRE 688 832 688 768
WIRE 688 832 384 832
WIRE -80 848 -80 832
WIRE -384 864 -384 832
WIRE 32 864 32 800
WIRE 96 864 32 864
WIRE 384 864 384 832
WIRE 384 864 176 864
WIRE -432 944 -544 944
WIRE -80 944 -80 928
WIRE 1216 944 1200 944
WIRE -544 976 -544 944
WIRE 1200 1024 1200 944
WIRE 1200 1040 1200 1024
WIRE 1248 1040 1200 1040
FLAG -1184 16 0
FLAG -1184 -64 5V
FLAG 480 592 5V
FLAG 304 272 0
FLAG 1040 96 0
FLAG 912 96 0
FLAG 1120 160 FILT
FLAG 544 160 OUT
FLAG 592 608 FB_VGND
FLAG 544 672 0
FLAG -160 448 em
FLAG 384 624 FB
FLAG 1328 512 0
FLAG 1456 512 0
FLAG 480 656 0
FLAG 752 560 0
FLAG 1120 736 FILT
FLAG 1136 1040 OUT
FLAG 1328 1040 0
FLAG 1312 736 0
FLAG -832 -16 0
FLAG -688 -80 5V_FILT
FLAG -912 -80 5V
FLAG -96 80 5V_FILT
FLAG -736 64 0
FLAG -608 304 5V_FILT
FLAG -160 784 5V
FLAG -160 848 0
FLAG -80 944 0
FLAG -320 816 gate
FLAG 624 352 INJECT
FLAG 912 432 0
FLAG 1008 432 0
FLAG 912 368 INJECT
FLAG 1008 368 OUT
FLAG -752 528 0
FLAG -656 528 0
FLAG -656 464 OUT
FLAG -752 464 gate
FLAG 1280 656 0
FLAG 1280 944 0
FLAG 1200 736 FILT_AC
FLAG 1200 1024 OUT_AC
FLAG -528 688 5V_FILT
FLAG -384 960 0
FLAG -544 1056 0
SYMBOL ind2 -208 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 Invisible 2
SYMATTR InstName Lp1
SYMATTR Value {(Np/2)**2 * Kn}
SYMATTR Type ind
SYMATTR SpiceLine Rser=0.065
SYMBOL ind2 -96 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 Invisible 2
SYMATTR InstName Lp2
SYMATTR Value {(Np/2)**2 * Kn}
SYMATTR Type ind
SYMATTR SpiceLine Rser=0.065
SYMBOL ind2 448 64 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 Invisible 2
SYMATTR InstName Ls
SYMATTR Value {Ns**2 * Kn}
SYMATTR Type ind
SYMATTR SpiceLine Rser=176
SYMBOL npn -288 256 R0
SYMATTR InstName Q1
SYMATTR Value 2N2222
SYMBOL voltage -1184 -80 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL cap -64 192 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 220n
SYMATTR SpiceLine Rser=0.3 IC=0
SYMBOL npn 96 256 M0
SYMATTR InstName Q2
SYMATTR Value 2N2222
SYMBOL ind2 -320 80 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 Invisible 2
SYMATTR InstName Lfb
SYMATTR Value {Np**2*Kn/2}
SYMATTR Type ind
SYMATTR SpiceLine Rser=0.1
SYMBOL res -464 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res 704 784 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 46.08k
SYMBOL cap 928 160 R180
WINDOW 40 -172 110 Left 2
SYMATTR SpiceLine2 Rser=16.4m Lser=16n
SYMATTR SpiceLine IC={V_OUT}
SYMATTR InstName C4
SYMATTR Value 68n
SYMBOL cap 1024 160 M180
SYMATTR SpiceLine IC={V_OUT}
SYMATTR SpiceLine2 Rser=16.4m Lser=16n
SYMATTR InstName C5
SYMATTR Value 68n
SYMBOL res 912 144 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 1312 176 R0
SYMATTR InstName R3
SYMATTR Value 1980k
SYMBOL fra 688 288 M0
SYMATTR InstName @1
SYMATTR SpiceLine delay=6m fstart=500 fend=30k oct=4 nmax=1 pp0=0.1 pp1=0.1 f0=1 f1=1k tavgmin=1m tsettle=0.5m
SYMBOL res 1312 256 R0
SYMATTR InstName R10
SYMATTR Value 330k
SYMBOL res 1312 336 R0
SYMATTR InstName R11
SYMATTR Value 330k
SYMBOL res 1312 416 R0
SYMATTR InstName R12
SYMATTR Value 160k
SYMBOL cap 1440 288 R0
SYMATTR InstName C9
SYMATTR Value 10n
SYMBOL cap 1440 368 R0
SYMATTR InstName C10
SYMATTR Value 10n
SYMBOL cap 1440 448 R0
SYMATTR InstName C11
SYMATTR Value 10n
SYMBOL res 672 416 R0
SYMATTR InstName R13
SYMATTR Value 9Meg
SYMBOL res 368 688 R0
SYMATTR InstName R7
SYMATTR Value 1
SYMBOL cap 752 544 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 15p
SYMBOL cap 1120 720 M90
WINDOW 39 24 84 Left 2
SYMATTR SpiceLine IC={V_OUT}
SYMATTR InstName C6
SYMATTR Value 10n
SYMBOL cap 1136 1024 M90
WINDOW 39 24 84 Left 2
SYMATTR SpiceLine IC={V_OUT}
SYMATTR InstName C7
SYMATTR Value 10n
SYMBOL res 1344 1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 330k
SYMBOL res 1328 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 330k
SYMBOL ind -928 -64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 100µ
SYMBOL cap -848 -80 R0
SYMATTR InstName C8
SYMATTR Value 47µ
SYMBOL res -752 -96 R0
SYMATTR InstName R9
SYMATTR Value 1.2
SYMBOL cap -752 0 R0
SYMATTR InstName C12
SYMATTR Value 188µ
SYMBOL sm2000 304 208 R180
WINDOW 0 48 0 Left 2
WINDOW 3 48 -32 Invisible 2
WINDOW 39 48 -53 Invisible 2
SYMATTR InstName U2
SYMBOL sm2000 384 272 R270
WINDOW 0 16 -8 VTop 2
WINDOW 3 -16 -8 Invisible 2
WINDOW 39 -37 -8 Invisible 2
SYMATTR InstName U4
SYMBOL sm2000 432 208 R180
WINDOW 0 48 0 Left 2
WINDOW 3 48 -32 Invisible 2
WINDOW 39 48 -53 Invisible 2
SYMATTR InstName U5
SYMBOL sm2000 384 160 R270
WINDOW 0 16 -8 VTop 2
WINDOW 3 -16 -8 Invisible 2
WINDOW 39 -37 -8 Invisible 2
SYMATTR InstName U6
SYMBOL res -208 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 220
SYMBOL voltage -80 832 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 4.096
SYMBOL fraprobe 960 448 R0
SYMATTR InstName &full
SYMBOL fraprobe -704 544 R0
SYMATTR InstName &power
SYMBOL res 192 848 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 220
SYMBOL ind -400 544 R0
SYMATTR InstName L1
SYMATTR Value 100µ
SYMBOL cap -128 592 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
WINDOW 39 60 32 VTop 2
SYMATTR InstName C13
SYMATTR Value 22n
SYMBOL res -112 592 R0
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL nmos -336 736 M0
SYMATTR InstName M1
SYMATTR Value DMG3402L
SYMATTR Prefix X
SYMBOL zener 1216 672 R270
WINDOW 0 36 32 VTop 2
WINDOW 3 -4 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value BZX84B7V5LY
SYMBOL zener 1216 960 R270
WINDOW 0 36 32 VTop 2
WINDOW 3 -4 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value BZX84B7V5LY
SYMBOL diode -416 672 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value 1N5817
SYMBOL nmos -432 864 R0
SYMATTR InstName M2
SYMATTR Value DMG3402L
SYMATTR Prefix X
SYMBOL voltage -544 960 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 5 1m 1u 1u 100 0 1)
SYMBOL OpAmps\\UniversalOpAmp5 480 624 M0
SYMATTR InstName U1
SYMATTR Value2 Avol=56k GBW=730k Phimargin=61 SlewPos=250k SlewNeg=250k
SYMATTR SpiceLine En=0 Enk=0 In=0 Ink=0 Rcm=10T Ccm=6p Rdiff=10T Cdiff=6p Ro=1k
SYMATTR SpiceLine2 Vos=150u Ibp=100p Ibn=100p Iq=90u Rail=0 Ilimit=25m
SYMBOL OpAmps\\UniversalOpAmp5 -160 816 M0
SYMATTR InstName U3
SYMATTR Value2 Avol=56k GBW=730k Phimargin=61 SlewPos=250k SlewNeg=250k
SYMATTR SpiceLine En=0 Enk=0 In=0 Ink=0 Rcm=10T Ccm=6p Rdiff=10T Cdiff=6p Ro=1k
SYMATTR SpiceLine2 Vos=150u Ibp=100p Ibn=100p Iq=90u Rail=0 Ilimit=25m
TEXT -264 -120 Left 2 !.param Lp=22u Np=1 Ns=100 Nfb=0.25\n.param Kn=Lp/Np**2\nK Lp1 Lp2 Ls Lfb 0.99
TEXT -1288 184 Left 2 ;.tran 20m startup
TEXT -1288 216 Left 2 !.fra startup
TEXT 1480 128 Left 2 ;PMT
TEXT -1280 352 Left 2 !.lib S1Y.lib\n.lib opa314.lib\n.lib DMG3402L.lib
TEXT -1272 472 Left 2 !.param V_OUT=-800
TEXT 848 8 Left 2 ;R76UN26805050J film caps
TEXT -200 -232 Left 2 ;22uH across both primaries\npri:sec:fb = 1:100:0.25
TEXT 536 928 Left 2 ;9M/800V = 11250 Ohm/V\n11250 * 4.096 = 46.08k
RECTANGLE Normal 1536 576 1264 112 2
